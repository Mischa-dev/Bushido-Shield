<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bushido Shield — Dashboard</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
    rel="stylesheet"
  />
  <style>
    :root{
      --brand:#DC2626;
      --ink:#0F172A;
      --t-info:#CFFAFE;
      --t-alert:#FEE2E2;
      --bg:#F7FAFC;
      --panel:#FFFFFF;
      --border:rgba(15,23,42,.10);
      --border-strong:rgba(15,23,42,.18);
      --success:#22C55E;
      --warning:#F59E0B;
      --info:#0EA5E9;
      --danger:#DC2626;
      --shadow-1:0 2px 10px rgba(15,23,42,.06);
      --shadow-2:0 10px 30px rgba(15,23,42,.12);
      --ring:rgba(220,38,38,.28);
      --font:"Inter", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      --r-card:16px;
      --r-ctl:10px;
      --r-pill:999px;
      --space-1:4px;
      --space-2:8px;
      --space-3:12px;
      --space-4:16px;
      --space-5:20px;
      --space-6:24px;
      --space-8:32px;
      --ease:cubic-bezier(.2,.8,.2,1);
      --dur:140ms;
    }
    [data-theme="dark"]{
      --bg:#0B1220;
      --panel:#0F172A;
      --border:rgba(148,163,184,.20);
      --border-strong:rgba(148,163,184,.32);
      --ink:#E5E7EB;
    }
    *{box-sizing:border-box;}
    body{margin:0;background:var(--bg);color:var(--ink);font:400 16px/1.6 var(--font);min-height:100vh;}
    body.pin-locked{overflow:hidden;}
    .app.is-locked{filter:blur(4px);pointer-events:none;user-select:none;}
    .pin-overlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(15,23,42,.55);backdrop-filter:blur(6px);z-index:200;padding:var(--space-6);}
    .pin-overlay.is-open{display:flex;}
    .pin-dialog{background:var(--panel);border:1px solid var(--border-strong);border-radius:var(--r-card);box-shadow:var(--shadow-2);padding:var(--space-6);max-width:420px;width:100%;display:flex;flex-direction:column;gap:var(--space-4);}
    .pin-dialog__form{display:flex;flex-direction:column;gap:var(--space-3);}
    .pin-dialog__inputs{display:flex;flex-direction:column;gap:var(--space-2);}
    .pin-dialog__error{color:var(--danger);font:600 13px var(--font);min-height:18px;}
    .pin-dialog__hint{font:500 13px var(--font);color:rgba(15,23,42,.65);margin:0;}
    .pin-dialog__title{margin:0;}
  .pin-dialog__success{color:var(--success);font:600 13px var(--font);min-height:18px;}
    img{max-width:100%;display:block;}
    a{color:var(--info);text-decoration:none;}
    a:hover{text-decoration:underline;}
    .app{max-width:1280px;margin:24px auto;padding:20px;background:var(--panel);border:1px solid var(--border);border-radius:var(--r-card);box-shadow:var(--shadow-2);display:flex;flex-direction:column;gap:var(--space-6);min-height:calc(100vh - 48px);}
    .hero{display:flex;align-items:center;justify-content:space-between;gap:var(--space-6);flex-wrap:wrap;}
    .brand{display:flex;align-items:center;gap:var(--space-4);}
    .brand__logo{width:64px;height:64px;border-radius:var(--r-card);box-shadow:var(--shadow-1);}
    .h1{font:700 28px/1.35 var(--font);color:var(--ink);margin:0;}
    .h2{font:600 22px/1.4 var(--font);color:var(--ink);margin:0;}
    .text{font:400 16px/1.6 var(--font);color:var(--ink);margin:0;}
    .text--muted{color:rgba(15,23,42,.65);}
    .label{font:500 14px/1 var(--font);color:rgba(15,23,42,.7);text-transform:uppercase;letter-spacing:.04em;}
    .num{font-variant-numeric:tabular-nums;}
    .hero__actions{display:flex;align-items:center;gap:var(--space-3);flex-wrap:wrap;}
  .pill{display:inline-flex;align-items:center;gap:.5ch;padding:.35rem .9rem;border-radius:var(--r-pill);border:1px solid var(--border);background:#fff;font:600 13px/1 var(--font);}
  .pill--ok,.pill.connected{background:color-mix(in srgb,#fff 90%, var(--success) 10%);border-color:color-mix(in srgb,var(--success) 40%, #fff 60%);}
  .pill--paused,.pill.paused{background:var(--t-alert);border-color:color-mix(in srgb, var(--danger) 40%, #fff 60%);}
  .pill--admin{background:color-mix(in srgb,#fff 88%, var(--brand) 12%);border-color:color-mix(in srgb, var(--brand) 50%, #fff 50%);color:var(--brand);}
  .pill--user{background:color-mix(in srgb,#fff 90%, var(--info) 10%);border-color:color-mix(in srgb, var(--info) 40%, #fff 60%);color:var(--info);}
    .btn{appearance:none;border-radius:var(--r-ctl);padding:.6rem .9rem;font:600 14px var(--font);border:1px solid var(--border);background:#fff;color:var(--ink);cursor:pointer;transition:transform var(--dur) var(--ease),box-shadow var(--dur) var(--ease);}
    .btn:hover{transform:translateY(-1px);box-shadow:var(--shadow-1);}
    .btn:focus{outline:3px solid var(--ring);outline-offset:2px;}
    .btn--primary{background:var(--brand);border-color:var(--brand);color:#fff;}
    .btn--ghost{background:transparent;}
    .tabs{display:flex;gap:var(--space-2);flex-wrap:wrap;}
    .tab{border:1px solid var(--border);border-radius:var(--r-pill);padding:.5rem .9rem;background:#fff;color:var(--ink);font:600 14px var(--font);cursor:pointer;transition:transform var(--dur) var(--ease),box-shadow var(--dur) var(--ease);}
    .tab:hover{transform:translateY(-1px);box-shadow:var(--shadow-1);}
    .tab.active,.tab.is-active{box-shadow:0 0 0 2px var(--brand) inset;background:color-mix(in srgb,#fff 92%, var(--brand) 8%);}
    .grid{display:grid;grid-template-columns:300px minmax(520px,1fr) 360px;gap:var(--space-5);flex:1 1 auto;}
    .pane{display:flex;flex-direction:column;gap:var(--space-5);min-height:0;}
    .panel{background:var(--panel);border:1px solid var(--border);border-radius:var(--r-card);box-shadow:var(--shadow-1);padding:var(--space-5);display:flex;flex-direction:column;gap:var(--space-4);min-height:0;position:relative;}
    .panel--muted{background:rgba(15,23,42,.02);box-shadow:none;}
    .panel--scroll{padding:0;overflow:hidden;}
    .panel__header{display:flex;flex-direction:column;gap:var(--space-1);margin-bottom:var(--space-3);}
    .panel--scroll .panel__header{margin:0;padding:20px 20px 16px;border-bottom:1px solid var(--border);position:sticky;top:0;z-index:2;background:var(--panel);}
    .panel__body{display:flex;flex-direction:column;gap:var(--space-3);}
    .panel--scroll .panel__body{padding:20px;overflow:auto;}
    .panel__body--flat{gap:var(--space-3);}
    .list{display:grid;gap:var(--space-2);}
    .rowi{display:flex;align-items:center;gap:var(--space-3);padding:var(--space-3);border:1px solid var(--border);border-radius:var(--r-ctl);background:#fff;cursor:pointer;transition:box-shadow var(--dur) var(--ease),transform var(--dur) var(--ease);}
    .rowi:hover{box-shadow:var(--shadow-1);transform:translateY(-1px);}
    .avatar{width:32px;height:32px;border-radius:50%;display:grid;place-items:center;background:rgba(15,23,42,.08);color:var(--ink);font:700 14px var(--font);}
    .dot{width:10px;height:10px;border-radius:50%;background:rgba(15,23,42,.16);}
    .dot.on{background:var(--success);}
    .dot.off{background:var(--danger);}
    .chips{display:flex;flex-wrap:wrap;gap:var(--space-2);}
    .chip{border:1px solid var(--border);border-radius:var(--r-pill);padding:.35rem .7rem;font:500 14px var(--font);background:#fff;color:var(--ink);cursor:pointer;transition:box-shadow var(--dur) var(--ease),transform var(--dur) var(--ease);display:inline-flex;align-items:center;gap:.4ch;}
    .chip:hover{background:rgba(15,23,42,.04);}
    .chip.is-selected,.chip.brand{background:color-mix(in srgb,#fff 90%, var(--brand) 10%);box-shadow:0 0 0 2px var(--brand) inset;border-color:var(--brand);}
    .field{display:flex;flex-direction:column;gap:var(--space-1);}
    .input,.panel input[type="text"],.panel input[type="password"],.panel input[type="search"],.panel input[type="number"],.panel textarea{width:100%;border:1px solid var(--border);border-radius:var(--r-ctl);padding:.5rem .7rem;background:#fff;color:var(--ink);font:500 14px var(--font);transition:border-color var(--dur) var(--ease),box-shadow var(--dur) var(--ease);}
    .input:focus,.panel input[type="text"]:focus,.panel input[type="password"]:focus,.panel input[type="search"]:focus,.panel input[type="number"]:focus,.panel textarea:focus{outline:3px solid var(--ring);outline-offset:2px;}
    .panel textarea{min-height:160px;padding:.7rem;}
    .select select,.panel select{appearance:none;-webkit-appearance:none;border:1px solid var(--border);border-radius:var(--r-ctl);padding:.5rem 2rem .5rem .7rem;height:40px;background:#fff url("data:image/svg+xml,%3Csvg viewBox='0 0 20 20' fill='%230F172A' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M5.5 7.5l4.5 5 4.5-5'/%3E%3C/svg%3E") no-repeat right .6rem center/16px;color:var(--ink);font:500 14px var(--font);transition:border-color var(--dur) var(--ease),box-shadow var(--dur) var(--ease);}
    .select select:focus,.panel select:focus{outline:3px solid var(--ring);outline-offset:2px;}
    input[type="checkbox"]{appearance:none;-webkit-appearance:none;width:18px;height:18px;border-radius:8px;border:1px solid var(--border);background:#fff;display:inline-grid;place-items:center;cursor:pointer;transition:background var(--dur) var(--ease),border-color var(--dur) var(--ease),box-shadow var(--dur) var(--ease);}
    input[type="checkbox"]::after{content:"";width:10px;height:6px;border:2px solid transparent;border-top:none;border-right:none;transform:rotate(-45deg);transition:border-color var(--dur) var(--ease);}
    input[type="checkbox"]:checked{background:var(--brand);border-color:var(--brand);box-shadow:var(--shadow-1);}
    input[type="checkbox"]:checked::after{border-color:#fff;}
    input[type="checkbox"]:focus-visible{outline:3px solid var(--ring);outline-offset:2px;}
    input[type="radio"]{appearance:none;-webkit-appearance:none;width:18px;height:18px;border-radius:50%;border:1px solid var(--border);background:#fff;display:inline-grid;place-items:center;cursor:pointer;transition:background var(--dur) var(--ease),border-color var(--dur) var(--ease);}
    input[type="radio"]::after{content:"";width:10px;height:10px;border-radius:50%;background:transparent;transition:background var(--dur) var(--ease);}
    input[type="radio"]:checked{border-color:var(--brand);}
    input[type="radio"]:checked::after{background:var(--brand);}
    input[type="radio"]:focus-visible{outline:3px solid var(--ring);outline-offset:2px;}
    .sw{display:inline-flex;align-items:center;gap:var(--space-3);cursor:pointer;}
    .sw input{position:absolute;opacity:0;}
    .sw__track{width:42px;height:24px;background:rgba(15,23,42,.14);border-radius:var(--r-pill);position:relative;transition:background var(--dur) var(--ease);}
    .sw__thumb{width:18px;height:18px;background:#fff;border-radius:50%;position:absolute;top:3px;left:3px;box-shadow:var(--shadow-1);transition:transform var(--dur) var(--ease);}
    .sw input:checked + .sw__track{background:var(--brand);}
    .sw input:checked + .sw__track .sw__thumb{transform:translateX(18px);}
    .sw input:focus + .sw__track{outline:3px solid var(--ring);outline-offset:2px;}
    .metrics{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:var(--space-4);}
    .tile{background:var(--panel);border:1px solid var(--border);border-radius:var(--r-card);box-shadow:var(--shadow-1);padding:var(--space-4);display:flex;flex-direction:column;gap:var(--space-2);}
    .tile--info{background:var(--t-info);}
    .tile--alert{background:var(--t-alert);}
    .tile--plain{background:#fff;}
    .card__actions{display:flex;gap:var(--space-3);flex-wrap:wrap;align-items:center;}
    .bars{display:flex;align-items:flex-end;gap:6px;height:70px;margin-top:var(--space-3);}
    .bars span{flex:1 1 auto;min-width:4px;background:rgba(15,23,42,.18);border-radius:999px;transition:background var(--dur) var(--ease);}
    .bars span:nth-child(odd){background:rgba(15,23,42,.12);}
    .bars span:hover{background:var(--brand);}
    .table-wrap{overflow:auto;border-radius:var(--r-card);background:#fff;}
    .table{width:100%;border-collapse:separate;border-spacing:0;min-width:640px;}
    .table th,.table td{padding:var(--space-3);border-bottom:1px solid var(--border);text-align:left;vertical-align:middle;}
    .table thead th{position:sticky;top:0;background:#fff;z-index:1;font:500 13px/1 var(--font);color:rgba(15,23,42,.75);text-transform:uppercase;letter-spacing:.05em;}
    .table tbody tr:hover{background:rgba(15,23,42,.03);}
    .table-actions{display:flex;flex-wrap:wrap;gap:var(--space-3);align-items:center;justify-content:space-between;margin-bottom:var(--space-4);}
    .sch-grid{display:grid;grid-template-columns:repeat(25,1fr);gap:4px;}
    .sch-grid .lbl{font:500 12px/1 var(--font);color:rgba(15,23,42,.6);text-align:center;}
    .sch-grid .cell{width:100%;aspect-ratio:1;height:auto;border-radius:6px;background:rgba(15,23,42,.08);cursor:pointer;transition:background var(--dur) var(--ease),box-shadow var(--dur) var(--ease);}
    .sch-grid .cell.on{background:var(--brand);box-shadow:var(--shadow-1);}
    .sch-grid .cell.on::after{content:"";display:block;width:100%;height:100%;border-radius:inherit;background:rgba(255,255,255,.18);}
    .toast-stack{position:fixed;right:20px;bottom:20px;display:grid;gap:var(--space-3);z-index:80;}
    .toast{background:#fff;border:1px solid var(--border);border-radius:12px;padding:.6rem .9rem;box-shadow:var(--shadow-2);font:600 14px var(--font);color:var(--ink);}
    .muted{color:rgba(15,23,42,.6);font-size:14px;margin:0;}
    #detailsBody>div{display:flex;flex-direction:column;gap:var(--space-3);}
    #detailsBody label{display:flex;align-items:center;gap:var(--space-2);font:500 14px var(--font);}
    #detailsBody select,#detailsBody input{flex:1;}
    .activity-list,.tip-list{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:var(--space-2);}
    .activity-list li,.tip-list li{font:500 14px/1.4 var(--font);color:var(--ink);}
    .app__footer{margin-top:auto;padding:var(--space-4) var(--space-5);background:#fff;border:1px solid var(--border);border-radius:var(--r-card);display:flex;justify-content:space-between;align-items:center;gap:var(--space-3);box-shadow:var(--shadow-1);}
    .app__footer a{font-weight:600;}
    /* Advanced modal */
    .modal-overlay{position:fixed;inset:0;background:rgba(15,23,42,.4);backdrop-filter:blur(4px);z-index:100;display:none;align-items:center;justify-content:center;padding:var(--space-6);}
    .modal-overlay.is-open{display:flex;}
    .modal{background:var(--panel);border:1px solid var(--border);border-radius:var(--r-card);box-shadow:var(--shadow-2);max-width:540px;width:100%;max-height:90vh;overflow:auto;padding:var(--space-6);display:flex;flex-direction:column;gap:var(--space-4);}
    .modal__header{display:flex;align-items:center;justify-content:space-between;gap:var(--space-4);}
    .modal__close{width:32px;height:32px;border-radius:var(--r-ctl);border:1px solid var(--border);background:#fff;color:var(--ink);font-size:20px;cursor:pointer;display:grid;place-items:center;transition:transform var(--dur) var(--ease);}
    .modal__close:hover{transform:scale(1.1);}
    .lock-badge{display:inline-flex;align-items:center;gap:.5ch;padding:.3rem .7rem;border-radius:var(--r-pill);background:var(--t-alert);border:1px solid color-mix(in srgb,var(--danger) 40%, #fff 60%);font:600 12px var(--font);color:var(--ink);}
    .lock-badge svg{width:14px;height:14px;}
    /* Overview Quick cards */
    .quick-grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:var(--space-4);}
    .quick-card{background:var(--panel);border:1px solid var(--border);border-radius:var(--r-card);box-shadow:var(--shadow-1);padding:var(--space-5);display:flex;flex-direction:column;gap:var(--space-4);min-height:320px;max-height:320px;}
    .quick-card--tall{min-height:660px;max-height:660px;grid-row:span 2;}
    .quick-card__header{display:flex;flex-direction:column;gap:var(--space-2);}
    .quick-card__body{flex:1 1 auto;overflow:auto;min-height:0;}
    .quick-card__footer{display:flex;align-items:center;justify-content:space-between;gap:var(--space-3);padding-top:var(--space-3);border-top:1px solid var(--border);margin-top:auto;flex-shrink:0;}
    .quick-card__footer a{font:600 14px var(--font);color:var(--brand);}
    .quick-card__footer a:hover{text-decoration:underline;}
    .overview-metrics-compact{display:grid;grid-template-columns:repeat(3,1fr);gap:var(--space-3);}
    .overview-metrics-compact .tile{padding:var(--space-3);}
    .overview-metrics-compact .label{font-size:11px;}
    .overview-metrics-compact .h2{font-size:18px;}
    /* Device row with controls */
    .device-row{display:flex;align-items:center;gap:var(--space-2);padding:var(--space-2) var(--space-3);border:1px solid var(--border);border-radius:var(--r-ctl);background:#fff;transition:box-shadow var(--dur) var(--ease);}
    .device-row:hover{box-shadow:var(--shadow-1);}
    .device-row__name{flex:1 1 auto;font:500 14px var(--font);min-width:120px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
    .device-row__select{flex:0 0 auto;appearance:none;border:1px solid var(--border);border-radius:var(--r-ctl);padding:.25rem 1.2rem .25rem .4rem;font:500 11px var(--font);background:#fff url("data:image/svg+xml,%3Csvg viewBox='0 0 20 20' fill='%230F172A' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M5.5 7.5l4.5 5 4.5-5'/%3E%3C/svg%3E") no-repeat right .3rem center/10px;cursor:pointer;max-width:95px;}
    .device-row__btn{flex:0 0 auto;border:0;background:transparent;color:var(--ink);font:500 14px var(--font);cursor:pointer;padding:.3rem .5rem;line-height:1;}
    .device-row__btn:hover{color:var(--brand);}
    .pause-controls{position:relative;flex:0 0 auto;}
    .pause-trigger{cursor:pointer;font-size:11px;padding:.25rem .4rem;min-height:26px;white-space:nowrap;border:1px solid var(--border);border-radius:var(--r-ctl);background:#fff;transition:background var(--dur) var(--ease);}
    .pause-trigger:hover{background:rgba(15,23,42,.04);}
    .pause-menu{position:absolute;left:0;top:calc(100% + 4px);background:#fff;border:1px solid var(--border);border-radius:10px;box-shadow:var(--shadow-2);padding:4px;display:none;min-width:110px;z-index:100;}
    .pause-menu button{border:none;background:transparent;text-align:left;padding:6px 8px;border-radius:8px;font:500 12px var(--font);cursor:pointer;width:100%;transition:background var(--dur) var(--ease);white-space:nowrap;}
    .pause-menu button:hover{background:rgba(15,23,42,.06);}
    /* Alert row */
    .alert-row{display:grid;grid-template-columns:auto 1fr auto auto;gap:var(--space-2);align-items:center;padding:var(--space-2);border:1px solid var(--border);border-radius:var(--r-ctl);background:#fff;font-size:13px;cursor:pointer;transition:box-shadow var(--dur) var(--ease);}
    .alert-row:hover{box-shadow:var(--shadow-1);}
    .alert-row__time{font:500 12px var(--font);color:rgba(15,23,42,.6);}
    .alert-row__domain{font:500 13px var(--font);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}
    .alert-row__action{font:600 11px var(--font);padding:.2rem .5rem;border-radius:var(--r-pill);text-transform:uppercase;letter-spacing:.03em;}
    .alert-row__action.blocked{background:var(--t-alert);color:var(--danger);}
    .alert-row__action.allowed{background:var(--t-info);color:var(--info);}
    .alert-row__scope{font:500 11px var(--font);color:rgba(15,23,42,.5);text-transform:uppercase;}
    /* Dropdown button */
    .btn-dropdown{position:relative;display:inline-flex;}
    .btn-dropdown__menu{position:absolute;top:100%;left:0;margin-top:4px;background:#fff;border:1px solid var(--border);border-radius:var(--r-ctl);box-shadow:var(--shadow-2);padding:var(--space-2);min-width:160px;display:none;z-index:10;}
    .btn-dropdown.is-open .btn-dropdown__menu{display:block;}
    .btn-dropdown__item{display:block;width:100%;text-align:left;padding:.5rem .7rem;border:0;background:transparent;border-radius:var(--r-ctl);font:500 14px var(--font);cursor:pointer;transition:background var(--dur) var(--ease);}
    .btn-dropdown__item:hover{background:rgba(15,23,42,.04);}
    /* Grid adjustments */
    .grid--two-col{grid-template-columns:minmax(0,1fr) 360px;}
    .grid--overview{grid-template-columns:minmax(0,1fr) 360px;}
    
    /* Profile Editor - Full Page (No Nested Scroll) */
    .panel__view{display:flex;flex-direction:column;height:100%;}
    .profile-editor-topbar{display:flex;align-items:center;gap:var(--space-3);padding:var(--space-4) 0;border-bottom:1px solid var(--border);margin-bottom:var(--space-4);}
    .profile-editor-content{max-width:900px;margin:0 auto;width:100%;padding-bottom:100px;}
    .profile-editor-footer{position:sticky;bottom:0;left:0;right:0;background:#fff;border-top:1px solid var(--border);padding:var(--space-3) var(--space-4);display:flex;justify-content:space-between;align-items:center;box-shadow:0 -2px 8px rgba(15,23,42,.08);z-index:10;}
    .profile-section{background:#fff;border:1px solid var(--border);border-radius:var(--r-card);padding:var(--space-4);margin-bottom:var(--space-4);}
    .profile-section__title{font:600 18px var(--font);color:var(--ink);margin:0 0 var(--space-3) 0;}
    .profile-toggles{display:flex;flex-direction:column;gap:var(--space-3);}
    .toggle-item{display:flex;align-items:center;gap:var(--space-2);font:500 14px var(--font);cursor:pointer;}
    .toggle-item input[type="checkbox"]{margin:0;}
    .profile-checklist{background:rgba(15,23,42,.02);border:1px solid var(--border);border-radius:var(--r-ctl);padding:var(--space-3);}
    .checklist-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:var(--space-2);}
    .checklist-grid label{display:flex;align-items:center;gap:var(--space-1);font:500 13px var(--font);cursor:pointer;}
    .profile-custom{background:rgba(15,23,42,.02);border:1px solid var(--border);border-radius:var(--r-ctl);padding:var(--space-3);}
    .profile-presets{display:flex;flex-wrap:wrap;gap:var(--space-2);}
    .chip--clickable{cursor:pointer;transition:all var(--dur) var(--ease);}
    .chip--clickable:hover{background:var(--brand);color:#fff;transform:translateY(-1px);}
    .profile-summary{background:rgba(15,23,42,.02);border:1px solid var(--border);border-radius:var(--r-ctl);padding:var(--space-3);font:500 13px var(--font);line-height:1.6;}
    .time-rule{background:#fff;border:1px solid var(--border);border-radius:var(--r-ctl);padding:var(--space-3);margin-bottom:var(--space-2);display:grid;grid-template-columns:1fr auto;gap:var(--space-3);align-items:start;}
    .time-rule__fields{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:var(--space-2);}
    .time-rule__actions{display:flex;gap:var(--space-2);align-items:center;}
    .device-apply-list{display:flex;flex-direction:column;gap:var(--space-2);max-height:300px;overflow-y:auto;padding:var(--space-2);background:rgba(15,23,42,.02);border:1px solid var(--border);border-radius:var(--r-ctl);}
    .device-apply-item{display:flex;align-items:center;gap:var(--space-2);padding:var(--space-2);background:#fff;border:1px solid var(--border);border-radius:var(--r-ctl);cursor:pointer;}
    .device-apply-item:hover{box-shadow:var(--shadow-1);}
    .device-apply-item input[type="checkbox"]{margin:0;}
    
    /* Profile Card - Consistent Button Styling */
    .profile-card{background:#fff;border:1px solid var(--border);border-radius:var(--r-card);padding:var(--space-4);display:flex;flex-direction:column;gap:var(--space-3);}
    .profile-card__header{display:flex;justify-content:space-between;align-items:flex-start;}
    .profile-card__title{font:600 16px var(--font);margin:0;color:var(--ink);}
    .profile-card__badge{font:500 11px var(--font);padding:.25rem .5rem;border-radius:var(--r-pill);background:rgba(15,23,42,.06);color:var(--ink);text-transform:uppercase;letter-spacing:.02em;}
    .profile-card__summary{font:500 13px var(--font);color:rgba(15,23,42,.6);line-height:1.5;}
    .profile-card__actions{display:flex;gap:var(--space-2);align-items:center;}
    .profile-card__actions .btn{flex:1;min-width:0;}
    .pane--quick.hidden{display:none;}
    @media (max-width:1199px){
      .grid{grid-template-columns:minmax(0,1fr);}
      .grid--two-col{grid-template-columns:minmax(0,1fr);}
      .grid--overview{grid-template-columns:minmax(0,1fr);}
      .pane--main{order:1;}
      .pane--quick{order:2;}
      .pane--details{order:3;}
    }
    @media (max-width:768px){
      .app{padding:var(--space-4);}
      .hero{flex-direction:column;align-items:flex-start;}
      .panel{padding:var(--space-4);}
      .panel--scroll .panel__header{padding:16px 16px 12px;}
      .panel--scroll .panel__body{padding:16px;}
      .quick-grid{grid-template-columns:1fr;}
      .quick-card{min-height:auto;max-height:none;}
      .quick-card--tall{min-height:auto;max-height:none;grid-row:auto;}
      .modal{padding:var(--space-4);}
    }
  </style>
</head>
<body class="pin-locked">
  <div id="pinOverlay" class="pin-overlay is-open" aria-hidden="false">
    <div class="pin-dialog" role="dialog" aria-modal="true" aria-labelledby="pinModalTitle">
      <h2 id="pinModalTitle" class="h2 pin-dialog__title">Enter Admin PIN</h2>
      <p class="pin-dialog__hint">This keeps the dashboard locked for kids.</p>
      <form id="pinForm" class="pin-dialog__form" autocomplete="off">
        <div class="pin-dialog__inputs">
          <label class="label" for="pinInput">Admin PIN</label>
          <input id="pinInput" class="input" type="password" inputmode="numeric" autocomplete="one-time-code" minlength="4" maxlength="12" required placeholder="Enter PIN" />
        </div>
        <p id="pinError" class="pin-dialog__error" role="alert" aria-live="assertive"></p>
        <div style="display:flex;gap:var(--space-3);justify-content:flex-end;">
          <button type="submit" class="btn btn--primary">Unlock</button>
        </div>
      </form>
    </div>
  </div>
  <div class="app is-locked">
    <header class="hero">
      <div class="brand">
        <img src="bushido_shield_logo.svg" alt="Bushido Shield logo" class="brand__logo" />
        <div>
          <p class="h1">Bushido Shield</p>
          <p class="text text--muted">Family internet protection, made friendly and bright.</p>
        </div>
      </div>
      <div class="hero__actions">
        <span id="statusPill" class="pill pill--ok">Connected</span>
        <button id="pauseBtn" class="btn btn--ghost">Pause 15m</button>
        <button id="resumeBtn" class="btn btn--primary" style="display:none;">Resume</button>
        <button id="advancedBtn" class="btn btn--ghost" title="Advanced Settings">
          <svg width="16" height="16" viewBox="0 0 20 20" fill="currentColor" style="vertical-align:middle;margin-right:4px;">
            <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd"/>
          </svg>
          Advanced
        </button>
      </div>
    </header>

    <div id="gridWrapper" class="grid">
      <aside class="pane pane--quick hidden" aria-label="Quick actions">
        <section class="panel panel--scroll">
          <div class="panel__header">
            <span class="label">Quick</span>
            <h2 class="h2">Devices</h2>
          </div>
          <div class="panel__body">
            <div class="field">
              <input id="qDevice" class="input" type="search" placeholder="Search devices…" />
            </div>
            <div id="quickDevices" class="list" role="list"></div>
            <button id="quickAddDevice" class="btn btn--ghost">+ Add device</button>
          </div>
        </section>

        <section class="panel">
          <div class="panel__header">
            <span class="label">Quick</span>
            <h2 class="h2">Profiles</h2>
          </div>
          <div class="panel__body panel__body--flat">
            <div id="quickProfiles" class="chips"></div>
            <button id="quickAddProfile" class="btn btn--ghost">+ New profile</button>
          </div>
        </section>

        <section class="panel">
          <div class="panel__header">
            <span class="label">Safety</span>
            <h2 class="h2">Parental Lock</h2>
          </div>
          <div class="panel__body panel__body--flat">
            <label class="sw">
              <input id="familyLock" type="checkbox" role="switch" aria-label="Family Mode" checked />
              <span class="sw__track"><span class="sw__thumb"></span></span>
              <span class="text">Family Mode (hide advanced tabs)</span>
            </label>
            <p class="muted">Keep advanced controls tucked away for younger users.</p>
          </div>
        </section>
      </aside>

      <main class="pane pane--main" aria-label="Main content">
        <section class="panel panel--muted">
          <div class="panel__body panel__body--flat">
            <nav class="tabs seg" role="tablist">
              <button class="tab active is-active" data-target="tab-main" role="tab" aria-selected="true">Overview</button>
              <button class="tab" data-target="tab-devices" role="tab">Devices</button>
              <button class="tab" data-target="tab-profiles" role="tab">Profiles</button>
              <button class="tab" data-target="tab-requests" role="tab">Requests</button>
              <button class="tab adv" data-target="tab-filtering" role="tab">Filtering</button>
              <button class="tab adv" data-target="tab-settings" role="tab">Settings</button>
              <button class="tab adv" data-target="tab-logs" role="tab">Logs</button>
            </nav>
          </div>
        </section>

        <section id="tab-main" class="panel" style="display:block;">
          <div class="panel__header">
            <h2 class="h2">Overview</h2>
            <p class="muted">Your protection at a glance</p>
          </div>
          <div class="panel__body panel__body--flat">
            <!-- 2-column grid with tall right card -->
            <div class="quick-grid">
              <!-- Today's Shield (Top-Left) -->
              <div class="quick-card">
                <div class="quick-card__header">
                  <span class="label">Today</span>
                  <h3 class="h2" style="font-size:18px;">Today's Shield</h3>
                </div>
                <div class="quick-card__body" style="overflow:visible;">
                  <div class="overview-metrics-compact">
                    <div class="tile tile--alert">
                      <span class="label">Ads</span>
                      <div class="h2 num" id="mAds">—</div>
                    </div>
                    <div class="tile tile--info">
                      <span class="label">Trackers</span>
                      <div class="h2 num" id="mTrackers">—</div>
                    </div>
                    <div class="tile tile--plain">
                      <span class="label">Devices</span>
                      <div class="h2 num" id="mDevices">0</div>
                    </div>
                  </div>
                  <div style="margin-top:var(--space-4);">
                    <div style="font:500 13px var(--font);color:rgba(15,23,42,.7);margin-bottom:var(--space-2);">Traffic (req/min)</div>
                    <div id="spark" class="bars" style="height:50px;"></div>
                  </div>
                </div>
                <div class="quick-card__footer">
                  <div class="btn-dropdown" id="pauseDropdown">
                    <button class="btn btn--primary" style="padding:.5rem .8rem;font-size:13px;">
                      Pause All ▾
                    </button>
                    <div class="btn-dropdown__menu">
                      <button class="btn-dropdown__item" data-duration="5">Pause 5m</button>
                      <button class="btn-dropdown__item" data-duration="15">Pause 15m</button>
                      <button class="btn-dropdown__item" data-duration="30">Pause 30m</button>
                      <button class="btn-dropdown__item" data-duration="60">Pause 1h</button>
                      <button class="btn-dropdown__item" data-duration="custom">Custom…</button>
                      <button class="btn-dropdown__item" data-action="disable-filtering">Disable filtering</button>
                      <button class="btn-dropdown__item" data-action="disable-ads">Disable ad blocker</button>
                    </div>
                  </div>
                  <button id="resumeMain" class="btn" style="display:none;padding:.5rem .8rem;font-size:13px;">Resume</button>
                  <span id="pauseNote" class="muted" style="font-size:12px;"></span>
                </div>
              </div>

              <!-- Quick Devices (Right - Double Height) -->
              <div class="quick-card quick-card--tall">
                <div class="quick-card__header">
                  <span class="label">Quick</span>
                  <h4 class="h2" style="font-size:18px;">Devices</h4>
                </div>
                <div class="quick-card__body">
                  <div class="field" style="margin-bottom:var(--space-3);">
                    <input id="qDeviceOverview" class="input" type="search" placeholder="Search devices…" style="height:36px;font-size:13px;" />
                  </div>
                  <div id="quickDevicesOverview" class="list" role="list" style="display:flex;flex-direction:column;gap:var(--space-2);"></div>
                </div>
                <div class="quick-card__footer">
                  <a href="#" data-tab="tab-devices" class="manage-link">View all devices →</a>
                </div>
              </div>

              <!-- Alerts & Requests (Bottom-Left) -->
              <div class="quick-card">
                <div class="quick-card__header">
                  <span class="label">Recent</span>
                  <h4 class="h2" style="font-size:18px;">Alerts & Requests</h4>
                </div>
                <div class="quick-card__body">
                  <div id="alertsRequestsOverview" style="display:flex;flex-direction:column;gap:var(--space-2);"></div>
                </div>
                <div class="quick-card__footer">
                  <a href="#" data-tab="tab-requests" class="manage-link">View all requests →</a>
                </div>
              </div>
            </div>
          </div>
        </section>

        <section id="tab-devices" class="panel" style="display:none;">
          <div class="panel__header">
            <h2 class="h2">Devices</h2>
            <p class="muted">Manage protection per device and apply friendly profiles.</p>
          </div>
          <div class="panel__body panel__body--flat">
            <div class="card__actions">
              <input id="deviceSearch" class="input" type="search" placeholder="Search devices…" />
              <div id="devicesFilters" class="chips">
                <span class="chip is-selected" data-f="all">All</span>
                <span class="chip" data-f="prot">Protected</span>
                <span class="chip" data-f="unprot">Unprotected</span>
              </div>
            </div>
            <div class="table-actions">
              <label class="text"><input type="checkbox" id="selectAll" class="cbx__input" /> Select all</label>
              <div class="card__actions">
                <button id="bulkToggle" class="btn">Toggle protection</button>
                <button id="bulkProfile" class="btn">Apply profile…</button>
              </div>
            </div>
            <div class="table-wrap">
              <table class="table">
                <thead>
                  <tr>
                    <th scope="col"></th>
                    <th scope="col">Name</th>
                    <th scope="col">IP / MAC</th>
                    <th scope="col">Shield</th>
                    <th scope="col">Profile</th>
                    <th scope="col">Access</th>
                    <th scope="col">Pause</th>
                    <th scope="col">Last seen</th>
                  </tr>
                </thead>
                <tbody id="deviceTable"></tbody>
              </table>
            </div>
          </div>
        </section>

        <section id="tab-profiles" class="panel" style="display:none;">
          <!-- Profile List View -->
          <div id="profilesList" class="panel__view">
            <div class="panel__header">
              <h2 class="h2">Profiles</h2>
              <p class="muted">Create custom filtering profiles with time rules and device assignments.</p>
            </div>
            <div class="panel__body panel__body--flat">
              <div class="card__actions">
                <button id="addProfileBtn" class="btn btn--primary">+ New Profile</button>
                <button id="exportProfilesBtn" class="btn">Export</button>
                <label class="btn" for="importProfilesInput">Import</label>
                <input id="importProfilesInput" type="file" accept="application/json" hidden />
              </div>
              <div id="profilesGrid" class="list" style="grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:var(--space-4);"></div>
            </div>
          </div>
          
          <!-- Profile Editor Full-Page View -->
          <div id="profileEditor" class="panel__view" style="display:none;">
            <div class="profile-editor-topbar">
              <button id="profileEditorClose" class="btn btn--ghost">← Back to Profiles</button>
              <h2 id="profileEditorTitle" class="h2" style="margin:0;">Edit Profile</h2>
            </div>
            
            <div class="profile-editor-content">
              <!-- Section 1: Basics -->
              <div class="profile-section">
                <h3 class="profile-section__title">Basics</h3>
                <div class="field">
                  <label class="label">Profile Name <span style="color:var(--danger);">*</span></label>
                  <input id="profName" class="input" type="text" placeholder="e.g., School, Focus, Gaming" required />
                </div>
                <div class="field">
                  <label class="label">Description (optional)</label>
                  <textarea id="profDesc" class="input" rows="2" placeholder="Short description of this profile's purpose"></textarea>
                </div>
              </div>

              <!-- Section 2: What to Block -->
              <div class="profile-section">
                <h3 class="profile-section__title">What to Block</h3>
                <div class="profile-toggles">
                  <label class="toggle-item">
                    <input type="checkbox" id="profBlockPorn" class="sw" />
                    <span>Pornographic content</span>
                  </label>
                  <label class="toggle-item">
                    <input type="checkbox" id="profBlockGambling" class="sw" />
                    <span>Gambling</span>
                  </label>
                  <label class="toggle-item">
                    <input type="checkbox" id="profBlockTrackers" class="sw" />
                    <span>Main trackers</span>
                  </label>
                  <label class="toggle-item">
                    <input type="checkbox" id="profBlockSocial" class="sw" />
                    <span>Social media</span>
                  </label>
                </div>
                
                <!-- Social Media Checklist -->
                <div id="socialMediaList" class="profile-checklist" style="display:none;margin-top:var(--space-3);">
                  <p class="muted" style="margin-bottom:var(--space-2);">Select social media platforms to block:</p>
                  <div class="checklist-grid">
                    <label><input type="checkbox" value="facebook.com" /> Facebook</label>
                    <label><input type="checkbox" value="instagram.com" /> Instagram</label>
                    <label><input type="checkbox" value="twitter.com" /> Twitter/X</label>
                    <label><input type="checkbox" value="tiktok.com" /> TikTok</label>
                    <label><input type="checkbox" value="snapchat.com" /> Snapchat</label>
                    <label><input type="checkbox" value="youtube.com" /> YouTube</label>
                    <label><input type="checkbox" value="reddit.com" /> Reddit</label>
                    <label><input type="checkbox" value="linkedin.com" /> LinkedIn</label>
                  </div>
                </div>

                <!-- Custom Block/Allow Lists -->
                <label class="toggle-item" style="margin-top:var(--space-3);">
                  <input type="checkbox" id="profCustomToggle" class="sw" />
                  <span>Custom block/allow lists</span>
                </label>
                <div id="customLists" class="profile-custom" style="display:none;margin-top:var(--space-3);">
                  <div class="field">
                    <label class="label">Block these domains/keywords</label>
                    <textarea id="profBlockList" class="input" rows="3" placeholder="example.com&#10;keyword1&#10;*.ads.com"></textarea>
                    <small class="muted">One per line. Use * for wildcards.</small>
                  </div>
                  <div class="field">
                    <label class="label">Always allow these domains</label>
                    <textarea id="profAllowList" class="input" rows="3" placeholder="school.edu&#10;work-site.com"></textarea>
                    <small class="muted">One per line. Overrides blocks.</small>
                  </div>
                </div>
              </div>

              <!-- Section 3: Quick Suggestions -->
              <div class="profile-section">
                <h3 class="profile-section__title">Quick Suggestions</h3>
                <p class="muted" style="margin-bottom:var(--space-3);">Tap a preset to auto-fill settings. You can still adjust after.</p>
                <div class="profile-presets">
                  <button class="chip chip--clickable" data-preset="homework">📚 Homework Mode</button>
                  <button class="chip chip--clickable" data-preset="school">🏫 School Day</button>
                  <button class="chip chip--clickable" data-preset="focus">🎯 Focus Max</button>
                  <button class="chip chip--clickable" data-preset="family">👨‍👩‍👧‍👦 Family Friendly</button>
                  <button class="chip chip--clickable" data-preset="gaming">🎮 Gaming Mode</button>
                  <button class="chip chip--clickable" data-preset="work">💼 Work Hours</button>
                </div>
              </div>

              <!-- Section 4: Time Rules (Routines) -->
              <div class="profile-section">
                <h3 class="profile-section__title">Time Rules</h3>
                <p class="muted" style="margin-bottom:var(--space-3);">Set when this profile's blocks are active.</p>
                <div id="timeRulesList"></div>
                <button id="addTimeRule" class="btn btn--ghost">+ Add Time Rule</button>
              </div>

              <!-- Section 5: Review & Save -->
              <div class="profile-section">
                <h3 class="profile-section__title">Review & Save</h3>
                <div id="profileSummary" class="profile-summary"></div>
              </div>
              
              <!-- Apply to Devices Section -->
              <div class="profile-section">
                <h3 class="profile-section__title">Apply to Devices</h3>
                <p class="muted" style="margin-bottom:var(--space-3);">Select devices to apply this profile immediately after saving.</p>
                <div class="field">
                  <input id="deviceApplySearch" class="input" type="search" placeholder="Search devices..." />
                </div>
                <div id="deviceApplyList" class="device-apply-list"></div>
              </div>
            </div>
            
            <!-- Sticky Footer -->
            <div class="profile-editor-footer">
              <button id="profileEditorCancel" class="btn">Cancel</button>
              <div style="display:flex;gap:var(--space-2);">
                <button id="profileEditorSave" class="btn btn--primary">Save Profile</button>
              </div>
            </div>
          </div>
        </section>

        <section id="tab-requests" class="panel" style="display:none;">
          <div class="panel__header">
            <h2 class="h2">Requests</h2>
            <p class="muted">Monitor and control every network request.</p>
          </div>
          <div class="panel__body panel__body--flat">
            <div class="card__actions">
              <input id="requestSearch" class="input" type="search" placeholder="Search domains…" style="max-width:300px;" />
              <div id="requestsFilters" class="chips">
                <span class="chip is-selected" data-f="all">All</span>
                <span class="chip" data-f="blocked">Blocked</span>
                <span class="chip" data-f="allowed">Allowed</span>
              </div>
            </div>
            <div class="table-wrap">
              <table class="table">
                <thead>
                  <tr>
                    <th scope="col">Time</th>
                    <th scope="col">Domain</th>
                    <th scope="col">Action</th>
                    <th scope="col">Scope</th>
                    <th scope="col">Device</th>
                    <th scope="col">Actions</th>
                  </tr>
                </thead>
                <tbody id="requestsTable"></tbody>
              </table>
            </div>
          </div>
        </section>

        <section id="tab-filtering" class="panel" style="display:none;">
          <div class="panel__header">
            <h2 class="h2">Filtering</h2>
            <p class="muted">Fine-tune blocklists, allowlists, and custom rules.</p>
          </div>
          <div class="panel__body panel__body--flat">
            <div class="chips" style="margin-bottom:var(--space-3);">
              <span class="chip brand">Blocklists</span>
              <span class="chip">Allowlist</span>
              <span class="chip">Custom rules</span>
            </div>
            <table class="table">
              <thead>
                <tr>
                  <th scope="col">Name</th>
                  <th scope="col">Source</th>
                  <th scope="col">Enabled</th>
                  <th scope="col">Last sync</th>
                </tr>
              </thead>
              <tbody id="blTable"></tbody>
            </table>
            <div class="card__actions" style="flex-wrap:wrap;">
              <label class="field" style="flex:1;">
                <span class="label">Allow domain</span>
                <input id="alInput" class="input" type="text" placeholder="example.com" />
              </label>
              <button id="alAdd" class="btn btn--primary">Add</button>
              <button id="blSync" class="btn">Sync now</button>
              <button id="blAdd" class="btn">Add list</button>
            </div>
            <div id="alChips" class="chips"></div>
            <label class="field">
              <span class="label">Custom rules (one per line)</span>
              <textarea id="crText" placeholder="||doubleclick.net^&#10;@@||youtube.com^$document"></textarea>
            </label>
            <div class="card__actions" style="justify-content:flex-end;">
              <button id="crValidate" class="btn">Validate</button>
              <button id="crApply" class="btn btn--primary">Apply</button>
            </div>
          </div>
        </section>

        <section id="tab-settings" class="panel" style="display:none;">
          <div class="panel__header">
            <h2 class="h2">Settings</h2>
            <p class="muted">Set DNS helpers and admin preferences.</p>
          </div>
          <div class="panel__body panel__body--flat">
            <div class="card__actions" style="flex-wrap:wrap;">
              <label class="field">
                <span class="label">Upstream DNS</span>
                <div class="select">
                  <select id="setDns">
                    <option value="quad9">Quad9</option>
                    <option value="cloudflare">Cloudflare</option>
                    <option value="google">Google</option>
                    <option value="custom">Custom…</option>
                  </select>
                </div>
              </label>
              <label class="field" id="setDnsCustomWrap" style="display:none;">
                <span class="label">Custom DNS</span>
                <input id="setDnsCustom" class="input" type="text" placeholder="1.1.1.1" />
              </label>
              <label class="field">
                <span class="label">Admin password</span>
                <input id="setAdmin" class="input" type="password" placeholder="••••••" />
              </label>
            </div>
            <div class="card__actions" style="justify-content:flex-end;">
              <button id="settingsSave" class="btn btn--primary">Save</button>
            </div>
          </div>
        </section>

        <section id="tab-logs" class="panel" style="display:none;">
          <div class="panel__header">
            <h2 class="h2">Logs</h2>
            <p class="muted">Browse recent activity across your network.</p>
          </div>
          <div class="panel__body panel__body--flat">
            <div id="logFilters" class="chips">
              <span class="chip" data-logfilter="all">All</span>
              <span class="chip" data-logfilter="blocked">Blocked</span>
              <span class="chip" data-logfilter="allowed">Allowed</span>
              <span class="chip" data-logfilter="policy">Policy</span>
            </div>
            <table class="table">
              <thead>
                <tr>
                  <th scope="col">Time</th>
                  <th scope="col">Domain</th>
                  <th scope="col">Action</th>
                  <th scope="col">Device</th>
                </tr>
              </thead>
              <tbody id="logsTable"></tbody>
            </table>
          </div>
        </section>
      </main>

      <aside class="pane pane--details" aria-label="Details">
        <section class="panel panel--scroll">
          <div class="panel__header">
            <span class="label">Details</span>
            <h2 class="h2" id="detailsTitle">Details</h2>
            <p class="muted" id="detailsSub">Select a device, profile, or routine.</p>
          </div>
          <div class="panel__body" id="detailsBody"></div>
        </section>

        <section class="panel">
          <div class="panel__header">
            <span class="label">Activity</span>
            <h2 class="h2">Recent</h2>
          </div>
          <div class="panel__body panel__body--flat">
            <ul id="activityList" class="activity-list"></ul>
          </div>
        </section>

        <section class="panel">
          <div class="panel__header">
            <span class="label">Tips</span>
            <h2 class="h2">Friendly nudges</h2>
          </div>
          <div class="panel__body panel__body--flat">
            <ul class="tip-list">
              <li>Use Bedtime to pause games after 9pm.</li>
              <li>Set School as default during weekdays.</li>
              <li>Allowlist homework sites for hassle-free access.</li>
            </ul>
            <a href="https://github.com/" target="_blank" rel="noreferrer">Help &amp; Docs</a>
          </div>
        </section>
      </aside>
    </div>

    <footer class="app__footer">
      <span>v0.1.0</span>
      <a href="http://localhost:5173" target="_blank" rel="noreferrer">Open full dashboard (localhost)</a>
    </footer>
  </div>

  <!-- Advanced Settings Modal -->
  <div id="advancedModal" class="modal-overlay" role="dialog" aria-labelledby="advModalTitle" aria-modal="true">
    <div class="modal">
      <div class="modal__header">
        <div>
          <h2 id="advModalTitle" class="h2">Advanced Settings</h2>
          <p class="muted" style="margin-top:var(--space-1);">Configure Family Mode and advanced features.</p>
        </div>
        <button id="closeAdvanced" class="modal__close" aria-label="Close Advanced Settings">×</button>
      </div>
      
      <div style="display:flex;flex-direction:column;gap:var(--space-5);">
        <!-- Device Binding -->
        <div class="panel" style="padding:var(--space-5);">
          <div class="panel__header" style="margin-bottom:0;">
            <span class="label">Extension</span>
            <h3 class="h2" style="font-size:18px;">Device Binding</h3>
            <p class="muted" style="margin-top:var(--space-2);">Bind this extension to a specific device so dashboard changes apply to it.</p>
          </div>
          <div style="margin-top:var(--space-4);display:flex;flex-direction:column;gap:var(--space-3);">
            <!-- Current binding status -->
            <div style="padding:var(--space-3);border-radius:var(--r-ctl);border:1px solid var(--border);background:rgba(15,23,42,.02);">
              <p class="label" style="margin:0;">Current Binding:</p>
              <p id="currentBindingStatus" class="text" style="margin:var(--space-1) 0 0 0;font-weight:500;">Loading...</p>
            </div>
            <!-- Device selector -->
            <div style="display:flex;gap:var(--space-2);align-items:flex-end;flex-wrap:wrap;">
              <div style="flex:1;min-width:200px;">
                <label class="label" for="deviceBindingSelect">Select Device:</label>
                <select id="deviceBindingSelect" style="width:100%;padding:var(--space-2);border:1px solid var(--border);border-radius:var(--r-ctl);font:500 14px var(--font);margin-top:var(--space-1);">
                  <option value="">Choose a device...</option>
                </select>
              </div>
              <button id="bindDeviceBtn" class="btn btn--primary" style="white-space:nowrap;">Bind Device</button>
              <button id="unbindDeviceBtn" class="btn" style="white-space:nowrap;display:none;">Unbind</button>
            </div>
          </div>
        </div>
        
        <!-- Family Mode / Parental Lock -->
        <div class="panel" style="padding:var(--space-5);">
          <div class="panel__header" style="margin-bottom:0;">
            <span class="label">Safety</span>
            <h3 class="h2" style="font-size:18px;">Family Mode</h3>
            <p class="muted" style="margin-top:var(--space-2);">Hide advanced tabs (Filtering, Settings, Logs) from younger users.</p>
          </div>
          <div style="margin-top:var(--space-4);">
            <label class="sw">
              <input id="familyLock" type="checkbox" role="switch" aria-label="Family Mode" checked />
              <span class="sw__track"><span class="sw__thumb"></span></span>
              <span class="text">Enable Family Mode</span>
            </label>
            <p class="muted" style="margin-top:var(--space-3);font-size:13px;">When enabled, advanced controls are tucked away for younger users. A lock badge will appear in the header.</p>
          </div>
        </div>

        <!-- Security / Admin PIN -->
        <div class="panel" style="padding:var(--space-5);">
          <div class="panel__header" style="margin-bottom:0;">
            <span class="label">Security</span>
            <h3 class="h2" style="font-size:18px;">Change Admin PIN</h3>
            <p class="muted" style="margin-top:var(--space-2);">Update the PIN required for the dashboard and extension devices view.</p>
          </div>
          <form id="pinChangeForm" class="pin-dialog__form" style="margin-top:var(--space-4);">
            <div class="field">
              <label class="label" for="pinChangeCurrent">Current PIN</label>
              <input id="pinChangeCurrent" class="input" type="password" inputmode="numeric" autocomplete="current-password" minlength="4" maxlength="12" required />
            </div>
            <div class="field">
              <label class="label" for="pinChangeNew">New PIN</label>
              <input id="pinChangeNew" class="input" type="password" inputmode="numeric" autocomplete="new-password" minlength="4" maxlength="12" required />
            </div>
            <div class="field">
              <label class="label" for="pinChangeConfirm">Confirm New PIN</label>
              <input id="pinChangeConfirm" class="input" type="password" inputmode="numeric" autocomplete="off" minlength="4" maxlength="12" required />
            </div>
            <p id="pinChangeFeedback" class="pin-dialog__error" role="alert" aria-live="assertive"></p>
            <div id="pinChangeSuccess" class="pin-dialog__success" aria-live="polite"></div>
            <div style="display:flex;gap:var(--space-3);justify-content:flex-end;margin-top:var(--space-3);">
              <button type="submit" class="btn btn--primary">Update PIN</button>
            </div>
          </form>
        </div>

        <!-- Additional advanced settings can go here in future -->
        <div class="panel" style="padding:var(--space-5);background:rgba(15,23,42,.02);box-shadow:none;">
          <p class="muted" style="font-size:14px;">
            <strong>Tip:</strong> You can access Filtering, Settings, and Logs tabs when Family Mode is disabled.
          </p>
        </div>
      </div>

      <div class="card__actions" style="justify-content:flex-end;padding-top:var(--space-4);border-top:1px solid var(--border);">
        <button id="closeAdvancedFooter" class="btn btn--primary">Done</button>
      </div>
    </div>
  </div>

  <div id="toast" class="toast-stack" aria-live="polite"></div>
  <script src="app.js" type="module"></script>
</body>
</html>
